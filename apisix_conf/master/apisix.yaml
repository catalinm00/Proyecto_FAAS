global_rules:
  - id: 1
    plugins:
      cors:
        allow_origins: "*"
        allow_methods: "*"
        allow_headers: "Content-Type, Authorization, X-API-KEY"
        expose_headers: "*"
        allow_credentials: true
        max_age: 3600
consumers:
  - username: jwt
    plugins:
      jwt-auth:
        key: apiserver-key
        secret: my-apiserver-secret-key
routes:
  -
    uri: /api-docs
    upstream:
      type: roundrobin
      nodes:
        "api-server:3000": 1

  -
    uri: /api-docs/*
    upstream:
      type: roundrobin
      nodes:
        "api-server:3000": 1

  -
    uri: /api/v1/functions
    upstream:
      type: roundrobin
      nodes:
        "api-server:3000": 1
    methods: ["POST", "GET", "DELETE"]
    plugins:
      jwt-auth: {}

  -
    uri: /api/v1/users/info/*
    upstream:
      type: roundrobin
      nodes:
        "api-server:3000": 1
    methods: ["GET"]
    plugins:
      jwt-auth: {}

  - uri: /api/v1/users/delete/*
    upstream:
      type: roundrobin
      nodes:
        "api-server:3000": 1
    methods: ["DELETE" ]
    plugins:
      jwt-auth: { }

  -
    uri: /api/v1/users
    upstream:
      type: roundrobin
      nodes:
        "api-server:3000": 1
    methods: ["POST"]

  -
    uri: /api/v1/users/login
    upstream:
      type: roundrobin
      nodes:
        "api-server:3000": 1
    methods: ["POST"]
#END